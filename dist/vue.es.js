function t(){return t=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},t.apply(this,arguments)}var r=String.prototype.replace,e=/%20/g,n={default:"RFC3986",formatters:{RFC1738:function(t){return r.call(t,e,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:"RFC3986"},i=Object.prototype.hasOwnProperty,o=Array.isArray,u=function(){for(var t=[],r=0;r<256;++r)t.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return t}(),s=function(t,r){for(var e=r&&r.plainObjects?Object.create(null):{},n=0;n<t.length;++n)void 0!==t[n]&&(e[n]=t[n]);return e},f={arrayToObject:s,assign:function(t,r){return Object.keys(r).reduce(function(t,e){return t[e]=r[e],t},t)},combine:function(t,r){return[].concat(t,r)},compact:function(t){for(var r=[{obj:{o:t},prop:"o"}],e=[],n=0;n<r.length;++n)for(var i=r[n],u=i.obj[i.prop],s=Object.keys(u),f=0;f<s.length;++f){var a=s[f],c=u[a];"object"==typeof c&&null!==c&&-1===e.indexOf(c)&&(r.push({obj:u,prop:a}),e.push(c))}return function(t){for(;t.length>1;){var r=t.pop(),e=r.obj[r.prop];if(o(e)){for(var n=[],i=0;i<e.length;++i)void 0!==e[i]&&n.push(e[i]);r.obj[r.prop]=n}}}(r),t},decode:function(t,r,e){var n=t.replace(/\+/g," ");if("iso-8859-1"===e)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(t){return n}},encode:function(t,r,e,i,o){if(0===t.length)return t;var s=t;if("symbol"==typeof t?s=Symbol.prototype.toString.call(t):"string"!=typeof t&&(s=String(t)),"iso-8859-1"===e)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var f="",a=0;a<s.length;++a){var c=s.charCodeAt(a);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||o===n.RFC1738&&(40===c||41===c)?f+=s.charAt(a):c<128?f+=u[c]:c<2048?f+=u[192|c>>6]+u[128|63&c]:c<55296||c>=57344?f+=u[224|c>>12]+u[128|c>>6&63]+u[128|63&c]:(c=65536+((1023&c)<<10|1023&s.charCodeAt(a+=1)),f+=u[240|c>>18]+u[128|c>>12&63]+u[128|c>>6&63]+u[128|63&c])}return f},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,r){if(o(t)){for(var e=[],n=0;n<t.length;n+=1)e.push(r(t[n]));return e}return r(t)},merge:function t(r,e,n){if(!e)return r;if("object"!=typeof e){if(o(r))r.push(e);else{if(!r||"object"!=typeof r)return[r,e];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,e))&&(r[e]=!0)}return r}if(!r||"object"!=typeof r)return[r].concat(e);var u=r;return o(r)&&!o(e)&&(u=s(r,n)),o(r)&&o(e)?(e.forEach(function(e,o){if(i.call(r,o)){var u=r[o];u&&"object"==typeof u&&e&&"object"==typeof e?r[o]=t(u,e,n):r.push(e)}else r[o]=e}),r):Object.keys(e).reduce(function(r,o){var u=e[o];return r[o]=i.call(r,o)?t(r[o],u,n):u,r},u)}},a=Object.prototype.hasOwnProperty,c={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,r){return t+"["+r+"]"},repeat:function(t){return t}},l=Array.isArray,h=String.prototype.split,p=Array.prototype.push,d=function(t,r){p.apply(t,l(r)?r:[r])},v=Date.prototype.toISOString,y=n.default,b={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:f.encode,encodeValuesOnly:!1,format:y,formatter:n.formatters[y],indices:!1,serializeDate:function(t){return v.call(t)},skipNulls:!1,strictNullHandling:!1},g=function t(r,e,n,i,o,u,s,a,c,p,v,y,g,m){var j,O=r;if("function"==typeof s?O=s(e,O):O instanceof Date?O=p(O):"comma"===n&&l(O)&&(O=f.maybeMap(O,function(t){return t instanceof Date?p(t):t})),null===O){if(i)return u&&!g?u(e,b.encoder,m,"key",v):e;O=""}if("string"==typeof(j=O)||"number"==typeof j||"boolean"==typeof j||"symbol"==typeof j||"bigint"==typeof j||f.isBuffer(O)){if(u){var w=g?e:u(e,b.encoder,m,"key",v);if("comma"===n&&g){for(var $=h.call(String(O),","),S="",E=0;E<$.length;++E)S+=(0===E?"":",")+y(u($[E],b.encoder,m,"value",v));return[y(w)+"="+S]}return[y(w)+"="+y(u(O,b.encoder,m,"value",v))]}return[y(e)+"="+y(String(O))]}var R,k=[];if(void 0===O)return k;if("comma"===n&&l(O))R=[{value:O.length>0?O.join(",")||null:void 0}];else if(l(s))R=s;else{var C=Object.keys(O);R=a?C.sort(a):C}for(var x=0;x<R.length;++x){var N=R[x],_="object"==typeof N&&void 0!==N.value?N.value:O[N];if(!o||null!==_){var D=l(O)?"function"==typeof n?n(e,N):e:e+(c?"."+N:"["+N+"]");d(k,t(_,D,n,i,o,u,s,a,c,p,v,y,g,m))}}return k},m=Object.prototype.hasOwnProperty,j=Array.isArray,O={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:f.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},w=function(t){return t.replace(/&#(\d+);/g,function(t,r){return String.fromCharCode(parseInt(r,10))})},$=function(t,r){return t&&"string"==typeof t&&r.comma&&t.indexOf(",")>-1?t.split(","):t},S=function(t,r,e,n){if(t){var i=e.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/g,u=e.depth>0&&/(\[[^[\]]*])/.exec(i),s=u?i.slice(0,u.index):i,f=[];if(s){if(!e.plainObjects&&m.call(Object.prototype,s)&&!e.allowPrototypes)return;f.push(s)}for(var a=0;e.depth>0&&null!==(u=o.exec(i))&&a<e.depth;){if(a+=1,!e.plainObjects&&m.call(Object.prototype,u[1].slice(1,-1))&&!e.allowPrototypes)return;f.push(u[1])}return u&&f.push("["+i.slice(u.index)+"]"),function(t,r,e,n){for(var i=n?r:$(r,e),o=t.length-1;o>=0;--o){var u,s=t[o];if("[]"===s&&e.parseArrays)u=[].concat(i);else{u=e.plainObjects?Object.create(null):{};var f="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,a=parseInt(f,10);e.parseArrays||""!==f?!isNaN(a)&&s!==f&&String(a)===f&&a>=0&&e.parseArrays&&a<=e.arrayLimit?(u=[])[a]=i:"__proto__"!==f&&(u[f]=i):u={0:i}}i=u}return i}(f,r,e,n)}};class E{constructor(t,r,e){var n,i;this.name=t,this.definition=r,this.bindings=null!=(n=r.bindings)?n:{},this.wheres=null!=(i=r.wheres)?i:{},this.config=e}get template(){return`${this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}/${this.definition.uri}`.replace(/\/+$/,"")}get parameterSegments(){var t,r;return null!=(t=null==(r=this.template.match(/{[^}?]+\??}/g))?void 0:r.map(t=>({name:t.replace(/{|\??}/g,""),required:!/\?}$/.test(t)})))?t:[]}matchesUrl(t){if(!this.definition.methods.includes("GET"))return!1;const r=this.template.replace(/\/{[^}?]*\?}/g,"(/[^/?]+)?").replace(/{[^}?]*\?}/g,"([^/?]+)?").replace(/{[^}]+}/g,"[^/?]+").replace(/^\w+:\/\//,"");return new RegExp(`^${r}$`).test(t.replace(/\/+$/,"").split("?").shift())}compile(t){return this.parameterSegments.length?this.template.replace(/{([^}?]+)\??}/g,(r,e)=>{var n,i;if([null,void 0].includes(t[e])&&this.parameterSegments.find(({name:t})=>t===e).required)throw new Error(`Ziggy error: '${e}' parameter is required for route '${this.name}'.`);return this.parameterSegments[this.parameterSegments.length-1].name===e&&".*"===this.wheres[e]?null!=(i=t[e])?i:"":encodeURIComponent(null!=(n=t[e])?n:"")}).replace(/\/+$/,""):this.template}}class R extends String{constructor(r,e,n=!0,i){if(super(),this.t=null!=i?i:"undefined"!=typeof Ziggy?Ziggy:null==globalThis?void 0:globalThis.Ziggy,this.t=t({},this.t,{absolute:n}),r){if(!this.t.routes[r])throw new Error(`Ziggy error: route '${r}' is not in the route list.`);this.i=new E(r,this.t.routes[r],this.t),this.u=this.l(e)}}toString(){const r=Object.keys(this.u).filter(t=>!this.i.parameterSegments.some(({name:r})=>r===t)).filter(t=>"_query"!==t).reduce((r,e)=>t({},r,{[e]:this.u[e]}),{});return this.i.compile(this.u)+function(t,r){var e,i=t,o=function(t){if(!t)return b;if(null!=t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var r=t.charset||b.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=n.default;if(void 0!==t.format){if(!a.call(n.formatters,t.format))throw new TypeError("Unknown format option provided.");e=t.format}var i=n.formatters[e],o=b.filter;return("function"==typeof t.filter||l(t.filter))&&(o=t.filter),{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:b.addQueryPrefix,allowDots:void 0===t.allowDots?b.allowDots:!!t.allowDots,charset:r,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:b.charsetSentinel,delimiter:void 0===t.delimiter?b.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:b.encode,encoder:"function"==typeof t.encoder?t.encoder:b.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:b.encodeValuesOnly,filter:o,format:e,formatter:i,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:b.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:b.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:b.strictNullHandling}}(r);"function"==typeof o.filter?i=(0,o.filter)("",i):l(o.filter)&&(e=o.filter);var u=[];if("object"!=typeof i||null===i)return"";var s=c[r&&r.arrayFormat in c?r.arrayFormat:r&&"indices"in r?r.indices?"indices":"repeat":"indices"];e||(e=Object.keys(i)),o.sort&&e.sort(o.sort);for(var f=0;f<e.length;++f){var h=e[f];o.skipNulls&&null===i[h]||d(u,g(i[h],h,s,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset))}var p=u.join(o.delimiter),v=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&(v+="iso-8859-1"===o.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),p.length>0?v+p:""}(t({},r,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,r)=>"boolean"==typeof t?Number(t):r(t)})}current(t,r){const e=this.t.absolute?this.h().host+this.h().pathname:this.h().pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"),[n,i]=Object.entries(this.t.routes).find(([r,n])=>new E(t,n,this.t).matchesUrl(e))||[void 0,void 0];if(!t)return n;const o=new RegExp(`^${t.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(n);if([null,void 0].includes(r)||!o)return o;const u=new E(n,i,this.t);r=this.l(r,u);const s=this.p(i);return!(!Object.values(r).every(t=>!t)||Object.values(s).length)||Object.entries(r).every(([t,r])=>s[t]==r)}h(){var t,r,e,n,i,o;const{host:u="",pathname:s="",search:f=""}="undefined"!=typeof window?window.location:{};return{host:null!=(t=null==(r=this.t.location)?void 0:r.host)?t:u,pathname:null!=(e=null==(n=this.t.location)?void 0:n.pathname)?e:s,search:null!=(i=null==(o=this.t.location)?void 0:o.search)?i:f}}get params(){return this.p(this.t.routes[this.current()])}has(t){return Object.keys(this.t.routes).includes(t)}l(r={},e=this.i){r=["string","number"].includes(typeof r)?[r]:r;const n=e.parameterSegments.filter(({name:t})=>!this.t.defaults[t]);return Array.isArray(r)?r=r.reduce((r,e,i)=>t({},r,n[i]?{[n[i].name]:e}:{[e]:""}),{}):1!==n.length||r[n[0].name]||!r.hasOwnProperty(Object.values(e.bindings)[0])&&!r.hasOwnProperty("id")||(r={[n[0].name]:r}),t({},this.v(e),this.g(r,e))}v(r){return r.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((r,{name:e},n)=>t({},r,{[e]:this.t.defaults[e]}),{})}g(r,{bindings:e,parameterSegments:n}){return Object.entries(r).reduce((r,[i,o])=>{if(!o||"object"!=typeof o||Array.isArray(o)||!n.some(({name:t})=>t===i))return t({},r,{[i]:o});if(!o.hasOwnProperty(e[i])){if(!o.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${i}' parameter is missing route model binding key '${e[i]}'.`);e[i]="id"}return t({},r,{[i]:o[e[i]]})},{})}p(r){var e;let n=this.h().pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"");const i=(r,e="",n)=>{const[i,o]=[r,e].map(t=>t.split(n));return o.reduce((r,e,n)=>/{[^}?]+\??}/.test(e)&&i[n]?t({},r,{[e.replace(/.*{|\??}.*/g,"")]:i[n].replace(e.match(/^[^{]*/g),"").replace(e.match(/[^}]*$/g),"")}):r,{})};return t({},i(this.h().host,r.domain,"."),i(n,r.uri,"/"),function(t,r){var e=O;if(""===t||null==t)return e.plainObjects?Object.create(null):{};for(var n="string"==typeof t?function(t,r){var e,n={},i=(r.ignoreQueryPrefix?t.replace(/^\?/,""):t).split(r.delimiter,Infinity===r.parameterLimit?void 0:r.parameterLimit),o=-1,u=r.charset;if(r.charsetSentinel)for(e=0;e<i.length;++e)0===i[e].indexOf("utf8=")&&("utf8=%E2%9C%93"===i[e]?u="utf-8":"utf8=%26%2310003%3B"===i[e]&&(u="iso-8859-1"),o=e,e=i.length);for(e=0;e<i.length;++e)if(e!==o){var s,a,c=i[e],l=c.indexOf("]="),h=-1===l?c.indexOf("="):l+1;-1===h?(s=r.decoder(c,O.decoder,u,"key"),a=r.strictNullHandling?null:""):(s=r.decoder(c.slice(0,h),O.decoder,u,"key"),a=f.maybeMap($(c.slice(h+1),r),function(t){return r.decoder(t,O.decoder,u,"value")})),a&&r.interpretNumericEntities&&"iso-8859-1"===u&&(a=w(a)),c.indexOf("[]=")>-1&&(a=j(a)?[a]:a),n[s]=m.call(n,s)?f.combine(n[s],a):a}return n}(t,e):t,i=e.plainObjects?Object.create(null):{},o=Object.keys(n),u=0;u<o.length;++u){var s=o[u],a=S(s,n[s],e,"string"==typeof t);i=f.merge(i,a,e)}return f.compact(i)}(null==(e=this.h().search)?void 0:e.replace(/^\?/,"")))}valueOf(){return this.toString()}check(t){return this.has(t)}}const k={install:(t,r)=>t.mixin({methods:{route:(t,e,n,i=r)=>function(t,r,e,n){const i=new R(t,r,e,n);return t?i.toString():i}(t,e,n,i)}})};export{k as ZiggyVue};
