!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.route=e()}(this,function(){"use strict";var n=function(t,e,r){if(this.name=t,this.ziggy=r,this.route=this.ziggy.namedRoutes[this.name],void 0===this.name)throw new Error("Ziggy Error: You must provide a route name");if(void 0===this.route)throw new Error("Ziggy Error: route '"+this.name+"' is not found in the route list");this.absolute=void 0===e||e,this.domain=this.setDomain(),this.path=this.route.uri.replace(/^\//,"")};n.prototype.setDomain=function(){if(!this.absolute)return"/";if(!this.route.domain)return this.ziggy.baseUrl.replace(/\/?$/,"/");var t=(this.route.domain||this.ziggy.baseDomain).replace(/\/+$/,"");return this.ziggy.basePort&&t.replace(/\/+$/,"")===this.ziggy.baseDomain.replace(/\/+$/,"")&&(t=this.ziggy.baseDomain+":"+this.ziggy.basePort),this.ziggy.baseProtocol+"://"+t+"/"},n.prototype.construct=function(){return this.domain+this.path};var o=function(o){function i(t,e,r,i){void 0===i&&(i=null),o.call(this),this.name=t,this.absolute=r,this.ziggy=i||Ziggy,this.template=this.name?new n(t,r,this.ziggy).construct():"",this.urlParams=this.normalizeParams(e),this.queryParams=this.normalizeParams(e)}return o&&(i.__proto__=o),((i.prototype=Object.create(o&&o.prototype)).constructor=i).prototype.normalizeParams=function(t){return void 0===t?{}:((t="object"!=typeof t?[t]:t).hasOwnProperty("id")&&-1==this.template.indexOf("{id}")&&(t=[t.id]),this.numericParamIndices=Array.isArray(t),Object.assign({},t))},i.prototype.with=function(t){return this.urlParams=this.normalizeParams(t),this},i.prototype.withQuery=function(t){return Object.assign(this.queryParams,t),this},i.prototype.hydrateUrl=function(){var n=this,s=this.urlParams,a=0,t=this.template.match(/{([^}]+)}/gi),u=!1;return t&&t.length!=Object.keys(s).length&&(u=!0),this.template.replace(/{([^}]+)}/gi,function(t,e){var r=t.replace(/\{|\}/gi,"").replace(/\?$/,""),i=n.numericParamIndices?a:r,o=n.ziggy.defaultParameters[r];if(o&&u&&(n.numericParamIndices?(s=Object.values(s)).splice(i,0,o):s[i]=o),a++,void 0!==s[i])return delete n.queryParams[i],s[i].id||encodeURIComponent(s[i]);if(-1===t.indexOf("?"))throw new Error("Ziggy Error: '"+r+"' key is required for route '"+n.name+"'");return""})},i.prototype.matchUrl=function(){this.urlParams;var t=window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname,e=this.template.replace(/(\{[^\}]*\})/gi,"[^/?]+").split("://")[1],r=t.replace(/\/?$/,"/");return new RegExp("^"+e+"/$").test(r)},i.prototype.constructQuery=function(){if(0===Object.keys(this.queryParams).length)return"";var r="?";return Object.keys(this.queryParams).forEach(function(t,e){void 0!==this.queryParams[t]&&null!==this.queryParams[t]&&(r=0===e?r:r+"&",r+=t+"="+encodeURIComponent(this.queryParams[t]))}.bind(this)),r},i.prototype.current=function(t){var e=this;void 0===t&&(t=null);var r=Object.keys(this.ziggy.namedRoutes).filter(function(t){return-1!==e.ziggy.namedRoutes[t].methods.indexOf("GET")&&new i(t,void 0,void 0,e.ziggy).matchUrl()})[0];return t?new RegExp(t.replace("*",".*").replace(".","."),"i").test(r):r},i.prototype.parse=function(){this.return=this.hydrateUrl()+this.constructQuery()},i.prototype.url=function(){return this.parse(),this.return},i.prototype.toString=function(){return this.url()},i.prototype.valueOf=function(){return this.url()},i}(String);return function(t,e,r,i){return new o(t,e,r,i)}});
