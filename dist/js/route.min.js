!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.route=e()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e,r){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&c(i,r.prototype),i}).apply(null,arguments)}function s(t){var n="function"==typeof Map?new Map:void 0;return(s=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return o(t,arguments,a(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,t)})(t)}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}var f=function(){function n(t,e,r){if(u(this,n),this.name=t,this.ziggy=r,this.route=this.ziggy.namedRoutes[this.name],void 0===this.name)throw new Error("Ziggy Error: You must provide a route name");if(void 0===this.route)throw new Error("Ziggy Error: route '".concat(this.name,"' is not found in the route list"));this.absolute=void 0===e||e,this.domain=this.setDomain(),this.path=this.route.uri.replace(/^\//,"")}return r(n,[{key:"setDomain",value:function(){if(!this.absolute)return"/";if(!this.route.domain)return this.ziggy.baseUrl.replace(/\/?$/,"/");var t=(this.route.domain||this.ziggy.baseDomain).replace(/\/+$/,"");return this.ziggy.basePort&&t.replace(/\/+$/,"")===this.ziggy.baseDomain.replace(/\/+$/,"")&&(t=this.ziggy.baseDomain+":"+this.ziggy.basePort),this.ziggy.baseProtocol+"://"+t+"/"}},{key:"construct",value:function(){return this.domain+this.path}}]),n}(),y=function(t){function o(t,e,r){var n,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return u(this,o),(n=l(this,a(o).call(this))).name=t,n.absolute=r,n.ziggy=i||Ziggy,n.template=n.name?new f(t,r,n.ziggy).construct():"",n.urlParams=n.normalizeParams(e),n.queryParams=n.normalizeParams(e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(o,s(String)),r(o,[{key:"normalizeParams",value:function(t){return void 0===t?{}:((t="object"!==e(t)?[t]:t).hasOwnProperty("id")&&-1==this.template.indexOf("{id}")&&(t=[t.id]),this.numericParamIndices=Array.isArray(t),i({},t))}},{key:"with",value:function(t){return this.urlParams=this.normalizeParams(t),this}},{key:"withQuery",value:function(t){return i(this.queryParams,t),this}},{key:"hydrateUrl",value:function(){var o=this,u=this.urlParams,a=0,t=this.template.match(/{([^}]+)}/gi),c=!1;return t&&t.length!=Object.keys(u).length&&(c=!0),this.template.replace(/{([^}]+)}/gi,function(t,e){var r=t.replace(/\{|\}/gi,"").replace(/\?$/,""),n=o.numericParamIndices?a:r,i=o.ziggy.defaultParameters[r];if(i&&c&&(o.numericParamIndices?(u=Object.values(u)).splice(n,0,i):u[n]=i),a++,void 0!==u[n])return delete o.queryParams[n],u[n].id||encodeURIComponent(u[n]);if(-1===t.indexOf("?"))throw new Error("Ziggy Error: '".concat(r,"' key is required for route '").concat(o.name,"'"));return""})}},{key:"matchUrl",value:function(){this.urlParams;var t=window.location.hostname+(window.location.port?":"+window.location.port:"")+window.location.pathname,e=this.template.replace(/(\{[^\}]*\})/gi,"[^/?]+").split("://")[1],r=t.replace(/\/?$/,"/");return new RegExp("^"+e+"/$").test(r)}},{key:"constructQuery",value:function(){if(0===Object.keys(this.queryParams).length)return"";var r="?";return Object.keys(this.queryParams).forEach(function(t,e){void 0!==this.queryParams[t]&&null!==this.queryParams[t]&&(r=0===e?r:r+"&",r+=t+"="+encodeURIComponent(this.queryParams[t]))}.bind(this)),r}},{key:"current",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=Object.keys(this.ziggy.namedRoutes).filter(function(t){return-1!==e.ziggy.namedRoutes[t].methods.indexOf("GET")&&new o(t,void 0,void 0,e.ziggy).matchUrl()})[0];return t?new RegExp(t.replace("*",".*").replace(".","."),"i").test(r):r}},{key:"parse",value:function(){this.return=this.hydrateUrl()+this.constructQuery()}},{key:"url",value:function(){return this.parse(),this.return}},{key:"toString",value:function(){return this.url()}},{key:"valueOf",value:function(){return this.url()}}]),o}();return function(t,e,r,n){return new y(t,e,r,n)}});
