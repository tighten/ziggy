!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("qs")):"function"==typeof define&&define.amd?define(["qs"],e):(t=t||self).route=e(t.qs)}(this,function(t){function e(){return(e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}).apply(this,arguments)}class r{constructor(t,r,i){var n;this.name=t,this.definition=r,this.bindings=null!=(n=r.bindings)?n:{},this.config=e({absolute:!0},i)}get template(){return(this.config.absolute?this.definition.domain?""+this.config.url.match(/^\w+:\/\//)[0]+this.definition.domain+(this.config.port?":"+this.config.port:""):this.config.url:"")+"/"+this.definition.uri}get parameterSegments(){var t,e;return null!=(t=null===(e=this.template.match(/{[^}?]+\??}/g))||void 0===e?void 0:e.map(t=>({name:t.replace(/{|\??}/g,""),required:!/\?}$/.test(t)})))?t:[]}matchesUrl(t){if(!this.definition.methods.includes("GET"))return!1;const e=this.template.replace(/\/{[^}?]*\?}/g,"(/[^/?]+)?").replace(/{[^}]+}/g,"[^/?]+").replace(/^\w+:\/\//,"");return new RegExp("^"+e+"$").test(t.replace(/\/+$/,"").split("?").shift())}compile(t){return this.parameterSegments.length?this.template.replace(/{([^}?]+)\??}/g,(e,r)=>{var i;if([null,void 0].includes(t[r])&&this.parameterSegments.find(({name:t})=>t===r).required)throw new Error("Ziggy error: '"+r+"' parameter is required for route '"+this.name+"'.");return encodeURIComponent(null!=(i=t[r])?i:"")}).replace(/\/+$/,""):this.template.replace(/\/+$/,"")}}class i extends String{constructor(t,i,n=!0,s){var o;if(super(),this.t=null!=(o=null!=s?s:Ziggy)?o:null===globalThis||void 0===globalThis?void 0:globalThis.Ziggy,t){if(!this.t.routes[t])throw new Error("Ziggy error: route '"+t+"' is not in the route list.");this.i=new r(t,this.t.routes[t],e({},this.t,{absolute:n})),this.s=this.o(i)}}toString(){const r=Object.keys(this.s).filter(t=>!this.i.parameterSegments.some(({name:e})=>e===t)).filter(t=>"_query"!==t).reduce((t,r)=>e({},t,{[r]:this.s[r]}),{});return this.i.compile(this.s)+t.stringify(e({},r,this.s.u),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0})}current(t,e){const i=window.location.host+window.location.pathname,[n,s]=Object.entries(this.t.routes).find(([e,n])=>new r(t,n,this.t).matchesUrl(i));if(!t)return n;const o=new RegExp("^"+t.replace(".","\\.").replace("*",".*")+"$").test(n);return e?(e=this.o(e,new r(n,s,this.t)),Object.entries(this.h(s)).filter(([t])=>e.hasOwnProperty(t)).every(([t,r])=>e[t]==r)):o}get params(){return this.h(this.t.routes[this.current()])}has(t){return Object.keys(this.t.routes).includes(t)}o(t={},r=this.i){t=["string","number"].includes(typeof t)?[t]:t;const i=r.parameterSegments.filter(({name:t})=>!this.t.defaults[t]);return Array.isArray(t)?t=t.reduce((t,r,n)=>e({},t,{[i[n].name]:r}),{}):1!==i.length||t[i[0].name]||!t.hasOwnProperty(Object.values(r.bindings)[0])&&!t.hasOwnProperty("id")||(t={[i[0].name]:t}),e({},this.l(r),this.g(t,r.bindings))}l(t){return t.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:r},i)=>e({},t,{[r]:this.t.defaults[r]}),{})}g(t,r={}){return Object.entries(t).reduce((t,[i,n])=>{if(!n||"object"!=typeof n||Array.isArray(n)||"_query"===i)return e({},t,{[i]:n});if(!n.hasOwnProperty(r[i])){if(!n.hasOwnProperty("id"))throw new Error("Ziggy error: object passed as '"+i+"' parameter is missing route model binding key '"+r[i]+"'.");r[i]="id"}return e({},t,{[i]:n[r[i]]})},{})}h(r){var i;let n=window.location.pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"");const s=(t,r="",i)=>{const[n,s]=[t,r].map(t=>t.split(i));return s.reduce((t,r,i)=>/^{[^}?]+\??}$/.test(r)&&n[i]?e({},t,{[r.replace(/^{|\??}$/g,"")]:n[i]}):t,{})};return e({},s(window.location.host,r.domain,"."),s(n,r.uri,"/"),t.parse(null===(i=window.location.search)||void 0===i?void 0:i.replace(/^\?/,"")))}valueOf(){return this.toString()}check(t){return this.has(t)}}return function(t,e,r,n){const s=new i(t,e,r,n);return t?s.toString():s}});
//# sourceMappingURL=route.js.map
